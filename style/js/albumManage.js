$(function(){    var page=0;    var user_id=$.cookie('user_id');    var url=window.location.href;    if(url.indexOf('uid')!==-1){        user_id=url.split('?')[1].split('=')[1];        $('.top').children('h1').html('他的相册');        $('.addListAlbum').hide();    }    console.log(user_id);    $.ajax({        url:'http://open.zhengjuan.com/api/app',        data:{            module:'user',            do:'getAlbumList',            page:(page++)*10,            user_id:user_id        },        type:'POST',        dataType:'jsonp',        success:function(data){            console.log(data)            var html='';            for (var i=0;i<data.data.length;i++){                console.log(data.data[i].coverpic)                html+='<li id="'+data.data[i].albumid+'">';//相册id                var url=window.location.href;                if(url.indexOf('uid')==-1){                    html+='<a href="albumList.html?type=no&albumid='+data.data[i].albumid+'&almbuname='+encodeURI(encodeURI(data.data[i].albumname))+'">';                }else  if(url.indexOf('uid')!==-1){                    html+='<a href="albumList.html?type=his&albumid='+data.data[i].albumid+'&almbuname='+encodeURI(encodeURI(data.data[i].albumname))+'">';                }                html+='<div class="albumImg"><span style="background:url('+data.data[i].coverpic+') no-repeat center;background-size:cover;"></span></div>';//封面图片                html+='<div class="albumImgInfo"><span>'+data.data[i].albumname+'</span></div>';//相册描述                html+='</a>';                html+='</li>';            }            $(html).insertBefore(".addListAlbum");        }    })    if (!NeuF) var NeuF = {};    NeuF.ScrollPage = function (obj, options, callback) {        var _defaultOptions = { delay: 500, marginBottom: 200 }; //默认配置：延迟时间delay和滚动条距离底部距离marginBottom        options = $.extend(_defaultOptions, options);        this.isScrolling = false; //是否在滚动        this.oriPos = 0; //原始位置        this.curPos = 0; //当前位置        var me = this; //顶层        var $obj = (typeof obj == "string") ? $("#" + obj) : $(obj);        //绑定滚动事件        $obj.scroll(function (ev) {            me.curPos = $obj.scrollTop();            if ($(window).height() + $(window).scrollTop() >= $(document.body).height() - options.marginBottom) {                if (me.isScrolling == true) return;                me.isScrolling = true;                setTimeout(function () { me.isScrolling = false;}, options.delay); //重复触发间隔毫秒;                if (typeof callback == "function") callback.call(null, me.curPos - me.oriPos);            };            me.oriPos = me.curPos;        });    };    $(function () {        if($('#thelist').find(".li").length<10){            $('.loading').hide();        }        var p=2;        new NeuF.ScrollPage(window, { delay: 500, marginBottom:500}, function (offset) {            if (offset > 0) {                $(".loading").show(); //加载提示.                data.page=num++*10;                setTimeout(function(){                    $('.loading').show();                    $.ajax({                        url:'http://open.zhengjuan.com/api/app',                        data:{                            module:'user',                            do:'getAlbumList',                            page:(page++)*10,                            user_id:user_id                        },                        dataType:'jsonp',                        jsonp:"callback",//传递给请求处理程序或页面的，用以获得jsonp回调函数名的参数名(默认为:callback)                        jsonpCallback:"success_jsonpCallback",//自定义的jsonp回调函数名称，默认为jQuery自动生成的随机函数名                        type:'POST',                        success:function(data){                            var html='';                            for (var i=0;i<data.data.length;i++){                                html+='<li id="'+data.data[i].albumid+'">';//相册id                                html+='<a href="albumList.html?albumid="+'+data.data[i].albumid+'>';                                html+='<div class="albumImg"><span style="background:url('+data.data[i].coverpic+') no-repeat center;background-size:cover;"></span></div>';//封面图片                                html+='<div class="albumImgInfo"><span>'+data.data[i].depict+'</span></div>';//相册描述                                html+='</a>';                                html+='</li>';                            }                            $(html).insertBefore(".addListAlbum");                            if(data.data.length==0){                                $('.loading span').html('没有更多了...')                                $('.loading img').remove();                            }                        }                    });                },1000)            }        });    });});