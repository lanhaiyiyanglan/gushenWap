$('.more').click(function(){    $('#journal').show();    $('.page-current').hide();});$('#journal').children('header').children('a').click(function(){    $('#journal').hide();    $('.page-current').show();})var page_Num = 0;$(document).ready(function(e) {    function x(tm) {        tm = parseInt(tm);        var date = new Date(tm); //转换成时间对象，这就简单了        var year = date.getFullYear();  //获取年        var mouth = date.getMonth() + 1 ;        var data = date.getDate();        if (date.getMonth() < 10) {            mouth = '0' + (date.getMonth()+1);        } else {            data = date.getDate();        }        if(date.getDate()<10) {            data = '0' + date.getDate();        }else{            data = date.getDate();        }        return year+'-'+mouth+'-'+data;    }    if (typeof($.cookie('password')) == 'undefined') {        window.location.href = '../../logRegPassword/index.html'    } else {    }    data={        module: 'user',        do: 'getWeblogList',        user_id: $.cookie('user_id'),        pagesize: 10,        page: page_Num    };    var url=window.location.href;    if(url.indexOf('uid')!==-1){        data.user_id=url.split('?')[1].split('=')[1];        $('.bar-nav').children('h1').html('他的日志');        $('.more').hide();    }    console.log(data)    $.ajax({        url: 'http://open.zhengjuan.com/api/app',        type: 'POST',        dataType: 'jsonp',        data:data        ,        success: function (data) {            console.log(data)            var logHtml = '';            for (var log = 0; log < data.data.length; log++) {                logHtml += '<li class="line-wrapper"><span class="userid" style="display:none;">'+data.data[log].user_id+'</span>';                logHtml += '<div class="pull-left line-scroll-wrapper">';                logHtml += '<a>';                logHtml += '<div class="line-normal-wrapper s1">';                logHtml += '<span>' + data.data[log].title + '</span>';                logHtml += '<div class="data">' + x(data.data[log].create_time * 1000) + '</div>';                logHtml += '</div></a>';                logHtml += '<div class="line-btn-delete">';                logHtml += '<button>删除</button>';                logHtml += '<input class="hidden_id" type="text" style="display:none;" value="' + data.data[log].blog_id + '"/>'                logHtml += '</div></div></li>';            }            $('#content').children('ul').append(logHtml);            var deleteBtn=$('.line-btn-delete').children('button')            for(var del=0;del<deleteBtn.length;del++){                $(deleteBtn[del]).on('click',function(){                    console.log(this)                    event.stopPropagation();                    var logVal=$(this).next('input').val();                    $('.ceng').fadeIn(500);                    $('.deleteLog').slideToggle(500);                    $('.deleteLog li:nth-child(1)').click(function(){                        console.log($(deleteBtn[del]))                        layer.open({                                title: false,                                skin: 'demo-class',                                closeBtn: 0,                                content: '确定要删除日志吗',                                area: ['60%', '7rem'],                                btn: ['取消', '确定'], //按钮                                cancel: function () {                                    //do something                                    $.ajax({                                        url: 'http://open.zhengjuan.com/api/app',                                        type: 'POST',                                        dataType: 'jsonp',                                        data: {                                            module: 'user',                                            do: 'deleteWeblog',                                            blog_id :logVal                                        },                                        success: function (data) {                                            $(this).parent().parent().parent().remove();                                            $('.ceng').hide();                                            $('.deleteLog').slideToggle(500);                                            layer.closeAll();                                            history.go(0);                                        }                                    })                                },                                yes: function (index, layero) {                                    layer.close(index);                                    $('.ceng').hide();                                    $('.deleteLog').slideToggle(500);                                    layer.closeAll();                                }                            }                        );                    })                    $('.deleteLog li:nth-child(2)').click(function(){                        $('.ceng').hide();                        $('.deleteLog').slideToggle(500);                        layer.closeAll();                    })                });            }            var url=window.location.href;            if(url.split('?')[1].split('=')[1]== $.cookie('user_id')){                $(".line-scroll-wrapper").width($(".line-wrapper").width() + $(".line-btn-delete").width());                // 设定常规信息区域宽度=屏幕宽度                $(".line-normal-wrapper").width($(".line-wrapper").width());                // 设定文字部分宽度（为了实现文字过长时在末尾显示...）                $(".line-normal-msg").width($(".line-normal-wrapper").width() - 180);                // 获取所有行，对每一行设置监听                var lines = $(".line-normal-wrapper");                var len = lines.length;                var lastX, lastXForMobile;                // 用于记录被按下的对象                var pressedObj;  // 当前左滑的对象                var lastLeftObj; // 上一个左滑的对象                // 用于记录按下的点                var start;                // 网页在移动端运行时的监听                for (var i = 0; i < len; ++i) {                    (function (p) {                        var abc = $(lines[p]).parent('a').next('.line-btn-delete').children('button');                        abc.click(function () {                            event.stopPropagation();                        })                    })(i);                    lines[i].addEventListener('touchstart', function (e) {                        lastXForMobile = e.changedTouches[0].pageX;                        pressedObj = this; // 记录被按下的对象                        // 记录开始按下时的点                        var touches = event.touches[0];                        start = {                            x: touches.pageX, // 横坐标                            y: touches.pageY  // 纵坐标                        };                    });                    lines[i].addEventListener('touchmove', function (e) {                        // 计算划动过程中x和y的变化量                        var touches = event.touches[0];                        delta = {                            x: touches.pageX - start.x,                            y: touches.pageY - start.y                        };                        // 横向位移大于纵向位移，阻止纵向滚动                        if (Math.abs(delta.x) > Math.abs(delta.y)) {                            event.preventDefault();                        }                    });                    lines[i].addEventListener('touchend', function (e) {                        var diffX = e.changedTouches[0].pageX - lastXForMobile;                        if (diffX < -150) {                            $(pressedObj).animate({marginLeft: "-100px"}, 500); // 左滑                            lastLeftObj && lastLeftObj != pressedObj &&                            $(lastLeftObj).animate({marginLeft: "0"}, 500); // 已经左滑状态的按钮右滑                            lastLeftObj = pressedObj; // 记录上一个左滑的对象                        } else if (diffX > 150) {                            $(pressedObj).animate({marginLeft: "0"}, 500); // 右滑                            lastLeftObj = null; // 清空上一个左滑的对象                        }                    });                }                // 网页在PC浏览器中运行时的监听                for (var i = 0; i < len; ++i) {                    $(lines[i]).bind('mousedown', function (e) {                        lastX = e.clientX;                        pressedObj = this; // 记录被按下的对象                    });                    $(lines[i]).bind('mouseup', function (e) {                        var diffX = e.clientX - lastX;                        if (diffX < -132) {                            $(pressedObj).animate({marginLeft: "-100px"}, 500); // 左滑                            lastLeftObj && lastLeftObj != pressedObj &&                            $(lastLeftObj).animate({marginLeft: "0"}, 500); // 已经左滑状态的按钮右滑                            lastLeftObj = pressedObj; // 记录上一个左滑的对象                        } else if (diffX > 132) {                            $(pressedObj).animate({marginLeft: "0"}, 500); // 右滑                            lastLeftObj = null; // 清空上一个左滑的对象                        }                    });                }            }else{                $('.s1 span').css('width','700px')            }        }    })    $(document).on('click','.line-wrapper',function(){        var url = "logDetail.html";        var blog_id = $(this).children('div').children('div').children('input').val();        var userid=$(this).children('.userid').html();        console.log(blog_id)        window.open(encodeURI(url + "?blog_id=" + blog_id+"&userid="+userid),'_self');        //encodeURI编码    });})$('.article_btn').click(function() {    var url=window.location.href;    var userid=url.split('?')[1].split('=')[1];    if($('#topTip').val().trim()==''||$('#articleContent').val().trim()=='') {        layer.msg('标题或者内容不能为空！',{            time: 2000,            area: ['80%'],            shade: [0.3, '#000'],            skin:'demo-success'        });    }else{        $.ajax({            url:'http://open.zhengjuan.com/api/app',            type:'POST',            dataType:'jsonp',            data:{                module:'user',                do:'publishWeblog',                user_id: $.cookie('user_id'),                title:$('#topTip').val(),                content:$('#articleContent').val()            },            success:function(data){                console.log(data)                if(data.code!==0){                    layer.msg('发表成功！', {time:2000,area:'80%',shade: [0.3, '#000'],skin:'demo-success',shadeClose:true,scrollbar: false});                    setTimeout(function(){window.location.href='logList.html?userid='+userid},2000)                }            }        })    }})