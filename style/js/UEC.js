var urlinfo = window.location.href;if(urlinfo.indexOf('app')!=-1){    var userid = urlinfo.split("?")[1].split("&")[0].split('=')[1];}else{    var userid = urlinfo.split("?")[1].split("=")[1];}$.ajax({    url:'http://open.zhengjuan.com/api/app',    type:'POST',    dataType:'jsonp',    data:{        module:'user',        do:'getUserdetailinfo',        user_id:userid,        login_user_id: $.cookie('user_id')    },    success:function(data){        if(data.data[0].role==1) {            $(function () {                $.ajax({                    url: 'http://site.gushen178.com/show/getgsauth',                    type: 'POST',                    dataType: 'jsonp',                    data: {                        u: window.location.href.split('?')[1].split('=')[1]                    },                    success: function (data) {                        console.log(data)                        if (data.zhengquan) {                            if (getJsonLength(data) == 0) {                                return false;                            } else {                                var AcData = [],                                    ProfitData = [],                                    ZQ = [];                                var Zlength = getJsonLength(data.zhengquan) - 1,                                    Alength = getJsonLength(data.retData.AcData) - 1,                                    Plength = getJsonLength(data.retData.ProfitData) - 1;                                for (var i = 0; i <= Zlength; i++) {                                    ZQ.push(data.zhengquan[i]);                                }                                for (var i = 0; i <= Alength; i++) {                                    var temp = [],                                        Ailength = getJsonLength(data.retData.AcData[i][2]);                                    for (var j = 1; j <= Ailength; j++) {                                        temp.push(data.retData.AcData[i][2][j]);                                    }                                    AcData.push(temp);                                }                                for (var z = 0; z <= Plength; z++) {                                    var mtemp = [],                                        Pzlength = getJsonLength(data.retData.ProfitData[z]);                                    for (var i = 2; i <= Pzlength; i++) {                                        var temp = [];                                        for (j = 1; j <= 4; j++) {                                            if (j == 1) {                                                temp.push(YMD(data.retData.ProfitData[z][i][j], 2));                                            } else {                                                temp.push(data.retData.ProfitData[z][i][j]);                                            }                                        }                                        mtemp.push(temp);                                    }                                    ProfitData.push(mtemp);                                }                                for (var i = 0; i < ZQ.length; i++) {                                    var tempAcData = AcData[i];                                    var tempProfitData = ProfitData[i];                                    var PT = baifen(tempAcData[7], tempAcData[6]);                                    var LT = baifen(tempAcData[8], tempAcData[6]);                                    var YEC = "YEC" + i,                                        LineEC = "LineEC" + i;                                    var leiji = tempProfitData[tempProfitData.length - 1][1] - tempProfitData[tempProfitData.length - 1][2];                                    var numarray = ['一', '二', '三', '四', '五']; //项目表识标签                                    var ModelHTML = '<div class="part">\                                            \<table style="font-size:3.5rem;">\                                               <tr>\                                                     <td><span>该高手提供实盘账户' + numarray[i] + '：</span></td>\                                               </tr>\                                               <tr>\                                                     <td>交易品种：' + ZQ[i][1] + '</td>\                                                     <td>用户名   ：' + ZQ[i][0] + '</td>\                                               </tr>\                                               <tr>\                                                     <td>开户机构：' + ZQ[i][2] + '</td>\                                                     <td>账户号码：' + ZQ[i][3] + '</td>\                                               </tr>\                                        </table>\                                     <div id="info">\                                         <div class="basedata">\                                             <div class="profiteInfo">\                                                 <div class="yearProfit">年化收益率：<span class="red">' + tempAcData[10] + '%</span></div>\                                                 <div class="surpassProfit">实盘累计收益率超出大盘：<span class="red">' + leiji.toFixed(2) + '%</span></div>\                                                 <div class="timeProfit">实盘统计区间：<span class="ea_time">' + YMD(tempAcData[0], 1) + '至' + YMD(tempAcData[1], 1) + '</span></div>\                                             </div>\                                             <div class="earn_ri">\                                                <div id="' + LineEC + '" class="LineEC"></div>\                                                <p class="p1">高手累计实盘收益<br>期末累计收益率<font color="red">' + tempProfitData[tempProfitData.length - 1][1] + '%</font></p>\                                                <p class="p2">大盘累计收益<br>期末累计收益率<font color="red">' + tempProfitData[tempProfitData.length - 1][2] + '%</font></p>\                                             </div>\                                             <div class="earn_main">\                                                 <a href=""><h3>[指标帮助说明]</h3></a>\                                                 <div class="earn_left">\                                                     <div class="profitOne">\                                                         <dl>\                                                             <dt class="specail">资产净收益：</dt>\                                                             <dd><span class="red">' + tempAcData[5] + '</span>万元</dd>\                                                         </dl>\                                                         <dl>\                                                             <dt>期初资金：</dt>\                                                             <dd><span class="red">' + tempAcData[2] + '</span>万元</dd>\                                                         </dl>\                                                         <dl>\                                                             <dt>期末资金：</dt>\                                                             <dd><span class="red">' + tempAcData[3] + '</span>万元</dd>\                                                         </dl>\                                                         <dl>\                                                             <dt>出入金额：</dt>\                                                             <dd><span class="red">' + tempAcData[4] + '</span>万元</dd>\                                                         </dl>\                                                     </div>\                                                     <div class="profitOne">\                                                         <dl>\                                                             <dt>回&nbsp;撤&nbsp;率：</dt>\                                                             <dd><span class="red">' + tempAcData[11] + '%</span></dd>\                                                         </dl>\                                                         <dl>\                                                             <dt>操盘风险度：</dt>\                                                             <dd><span class="red">' + tempAcData[13] + '</span></dd>\                                                         </dl>\                                                     </div>\                                                 </div>\                                                 <div class="earn_right">\                                                     <div id="' + YEC + '" class="bingtu" style="height:500px;width:100%;"></div>\                                                     <div class="zhang"><i></i>占总交易量<span class="red">' + PT + '%</span></div>\                                                     <div class="die"><i></i>占总交易量<span class="red">' + LT + '%</span></div>\                                                 </div>\                                             </div>\                                         </div>\                                     </div>\                                 </div>';                                    jQuery("#chartDiscount").append(ModelHTML);                                    // 盈亏交易量                                    var chartData = [{                                        "country": "亏损交易",                                        "value": tempAcData[8]                                    }, {                                        "country": "盈利交易",                                        "value": tempAcData[7]                                    }];                                    var YEC = AmCharts.makeChart(YEC, {                                        "type": "pie",                                        "theme": "light",                                        "dataProvider": chartData,                                        "valueField": "value",                                        "titleField": "country",                                        "outlineAlpha": 0.4,                                        "depth3D": 20,                                        "outlineColor": "#FFFFFF",                                        "outlineThickness": 0,                                        "balloonText": "[[title]]<br><span style='font-size:14px'><b>[[value]]笔</b> ([[percents]]%)</span>",                                        "angle": 40,                                        "export": {                                            "enabled": true                                        }                                    });                                    // 日收益折线                                    var Mdate = [],                                        Mdata = [],                                        MVolume = [],                                        Titem = [],                                        MiMa;                                    for (j = 0; j < tempProfitData.length; j++) {                                        Mdate.push(tempProfitData[j][0]);                                        var item = {                                            value: tempProfitData[j][2],                                            index: tempProfitData[j][3]                                        };                                        Mdata.push(item);                                        Titem.push(tempProfitData[j][2]);                                        MVolume.push(tempProfitData[j][1]);                                    }                                    MiMa = MaxMin(Math.max.apply(null, Titem), Math.max.apply(null, MVolume), Math.min.apply(null, Titem), Math.min.apply(null, MVolume));                                    var optionLineEC = {                                        grid: {                                            x: 40,                                            y: 20,                                            x2: 0,                                            y2: 30,                                            borderColor: '#fff'                                        },                                        tooltip: {                                            trigger: 'axis',                                            formatter: function (params) {                                                var res = params[0].name;                                                res += "<br/>" + params[0].seriesName + "率:" + params[0].value + "%";                                                res += "<br/>" + params[1].seriesName + "率:" + params[1].value + "%";                                                res += "<br/>大盘指数: " + params[1].data.index;                                                return res                                            }                                        },                                        calculable: true,                                        xAxis: [{                                            type: 'category',                                            boundaryGap: false,                                            data: Mdate                                        }],                                        yAxis: [{                                            type: 'value',                                            max: MiMa[0],                                            min: MiMa[1],                                            axisLabel: {                                                formatter: function (value) {                                                    return parseInt(value) + '%'                                                }                                            },                                            boundaryGap: [0.05, 0.05],                                            splitLine: {                                                show: true,                                                lineStyle: {                                                    color: ['#ccc'],                                                    width: 1,                                                    type: 'dashed'                                                }                                            },                                            splitNumber: 5,                                            axisLine: {                                                show: false                                            }                                        }],                                        series: [{                                            name: '实盘收益',                                            type: 'line',                                            symbol: 'none',                                            data: MVolume,                                            markLine: {                                                data: [{                                                    type: 'average',                                                    name: '平均值'                                                }]                                            }                                        }, {                                            name: '大盘收益',                                            type: 'line',                                            symbol: 'none',                                            data: Mdata,                                            markLine: {                                                data: [{                                                    type: 'average',                                                    name: '平均值'                                                }]                                            }                                        }]                                    };                                    document.getElementById(LineEC).style.width = '100%';                                    document.getElementById(LineEC).style.height = '500px';                                    var LineEC = echarts.init(document.getElementById(LineEC));                                    LineEC.setOption(optionLineEC);                                }                                $('.touziyeji').children('div').not('div:nth-child(1)').hide();                                if(urlinfo.indexOf('type')==-1){                                    $('.shipanzhanghu').css('margin-top','-5rem')                                }                            }                        }else{                            $('#chartDiscount').hide();                            $('.touziyeji').show();                            $('.shipanzhanghu').hide()                        }                    }                });            });            function MaxMin(i1, i2, i3, i4) {                var tmax, tmin;                if (i1 < 1 && i1 > 0 && i2 < 1 && i2 > 0) {                    tmax = 1;                } else if (i1 > i2) {                    tmax = i1 + 2;                } else {                    tmax = i2 + 2;                }                if (i3 > -1 && i3 < 0 && i4 > -1 && i3 < 0) {                    tmin = -1;                } else if (i3 > i4) {                    tmin = i4 + 2;                } else {                    tmin = i3 + 2;                }                return [tmax, tmin];            }            function YMD(str, t) {                var temp;                if (typeof str != "undefined") {                    if (t == 1) {                        temp = str.substr(0, 4) + "年" + str.substr(4, 2) + "月" + str.substr(6, 2) + "日";                    } else {                        temp = str.substr(0, 4) + "/" + str.substr(4, 2) + "/" + str.substr(6, 2);                    }                }                return temp;            }            function baifen(i, j) {                return (i / j * 100).toFixed(2);            }            function getJsonLength(jsonData) {                var jsonLength = 0;                for (var item in jsonData) {                    jsonLength++;                }                var UA = navigator.userAgent.toLowerCase();                if (navigator.appName == "Microsoft Internet Explorer" && navigator.appVersion.split(";")[1].replace(/[ ]/g, "") == "MSIE6.0") {                    jsonLength -= 1;                } else if (navigator.appName == "Microsoft Internet Explorer" && navigator.appVersion.split(";")[1].replace(/[ ]/g, "") == "MSIE7.0") {                    if (!(UA.indexOf('se') > -1 && UA.indexOf('qqbrowser') == -1 && UA.indexOf('360se') == -1)) {                        jsonLength -= 1;                    }                } else if (navigator.appName == "Microsoft Internet Explorer" && navigator.appVersion.split(";")[1].replace(/[ ]/g, "") == "MSIE8.0") {                    jsonLength -= 1;                }                return jsonLength;            }        }else{            $('#chartDiscount').hide();        }    }})